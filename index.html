<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Game with Referrals</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        .button-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="button-container">
        <button class="button" id="playButton">Играть</button>
        <button class="button" id="referralButton">Рефералы</button>
        <button class="button" id="tasksButton">Задания</button>
    </div>

    <div id="gameContainer" style="display: none;">
        <!-- Placeholder for game content -->
        <canvas id="gameCanvas" width="400" height="400"></canvas>
        <div class="controls">
            <!-- Game controls -->
            <div class="side-controls">
                <button class="control-button" id="left">←</button>
            </div>
            <div>
                <button class="control-button" id="up">↑</button>
                <button class="control-button" id="down">↓</button>
            </div>
            <div class="side-controls">
                <button class="control-button" id="right">→</button>
            </div>
        </div>
        <div class="user-info" id="userInfo"></div>
        <div class="score" id="score">Score: 0</div>
    </div>

    <div id="referralModal" style="display: none;">
        <!-- Modal for referral information -->
        <h3>Referral Information</h3>
        <p id="referralCount">Referrals: 0</p>
        <p id="earnedPoints">Earned Points: 0</p>
        <p>Referral Link: <a href="#" id="referralUrl">Your Telegram Referral Link</a></p>
        <ul id="referralList"></ul>
        <button id="closeModal">Close</button>
    </div>

    <div id="tasksContainer" style="display: none;">
        <!-- Placeholder for tasks content -->
        <h2>Задания</h2>
        <p>Здесь будут отображаться ваши задания...</p>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        Telegram.WebApp.ready();

        const user = Telegram.WebApp.initDataUnsafe.user;
        const userInfoDiv = document.getElementById('userInfo');
        userInfoDiv.innerHTML = `
            <h3>User Information</h3>
            <p>Username: ${user.username}</p>
            <p>First Name: ${user.first_name}</p>
            <p>Last Name: ${user.last_name}</p>
        `;

        const playButton = document.getElementById('playButton');
        const gameContainer = document.getElementById('gameContainer');
        const referralButton = document.getElementById('referralButton');
        const referralModal = document.getElementById('referralModal');
        const tasksButton = document.getElementById('tasksButton');
        const tasksContainer = document.getElementById('tasksContainer');

        playButton.addEventListener('click', () => {
            gameContainer.style.display = 'block';
            referralModal.style.display = 'none';
            tasksContainer.style.display = 'none';
            // Place game initialization logic here
            initializeGame();
        });

        referralButton.addEventListener('click', () => {
            gameContainer.style.display = 'none';
            referralModal.style.display = 'block';
            tasksContainer.style.display = 'none';
            updateReferralInfo();
        });

        tasksButton.addEventListener('click', () => {
            gameContainer.style.display = 'none';
            referralModal.style.display = 'none';
            tasksContainer.style.display = 'block';
        });

        function initializeGame() {
            // Game initialization logic here
            // For example, setting up canvas, controls, etc.
            const canvas = document.getElementById('gameCanvas');
            const context = canvas.getContext('2d');
            const scoreElement = document.getElementById('score');
            // Add game logic here
        }

        function updateReferralInfo() {
            // Referral information update logic here
            // Fetch data from backend or update as necessary
            const referralCountElement = document.getElementById('referralCount');
            const earnedPointsElement = document.getElementById('earnedPoints');
            const referralUrlElement = document.getElementById('referralUrl');
            const referralListElement = document.getElementById('referralList');

            referralCountElement.textContent = `Referrals: ${referrals}`;
            earnedPointsElement.textContent = `Earned Points: ${earnedPoints}`;
            referralUrlElement.href = `https://t.me/Tester_tapalka_bot?start=${user.id}`; // Replace with your bot username and referral parameter
            referralListElement.innerHTML = ''; // Clear previous list

            // Example: Add referral list items
            // referralList.forEach(referral => {
            //     const li = document.createElement('li');
            //     li.textContent = referral;
            //     referralListElement.appendChild(li);
            // });
        }
    </script>
</body>
</html>
